# HTTP笔记 

## 一、HTTP概述

概念：超文本传输协议

可理解为:HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范

【传输协议】：定义了客户端和服务器端通信时发送**数据的格式**

* 特点

  1. 基于TCP/IP的高级协议
  2. 默认端口号：80
  3. 基于请求/响应模型的：一次请求对应一次响应
  4. 无状态的：每次请求之间相互独立，不能交互数据

* 历史版本：

  1.0 ：每一次请求响应都会建立新的连接

  1.1 ：复用连接

## 二、请求消息

请求消息：客户端发送给服务器端的数据

* 数据格式：请求行、请求头、请求空行、请求体
* <img src="C:\Users\86184\AppData\Roaming\Typora\typora-user-images\image-20220320192657653.png" alt="image-20220320192657653" style="zoom:50%;" />

### 2.1请求行

* 请求方式 请求url 请求协议/版本

  GET /login.html HTTP/1.1

* 【请求方法共有7种，常用的两种GET和POST】

  **GET**：

  1. **请求参数在请求行中，在url后**
  2. 请求的url长度有限制的
  3. 较不安全
  4. 重点在从服务器上获取资源
  5. 只能支持ASCII字符

  **POST**：

  1. **请求参数在请求体中**
  2. 请求的url长度没有限制的
  3. 较安全
  4. 重点在向服务器发送数据
  5. 支持标准字符集，可以正确传递中文字符

  ***

  (1)GET： 用于请求访问已经被URI（统一资源标识符）识别的资源，可以通过URL传参给服务器
  (2)POST：用于传输信息给服务器，主要功能与GET方法类似，但一般推荐使用POST方式。
  (3)PUT： 传输文件，报文主体中包含文件内容，保存到对应URI位置。
  (4)HEAD： 获得报文首部，与GET方法类似，只是不返回报文主体，一般用于验证URI是否有效。
  (5)DELETE：删除文件，与PUT方法相反，删除对应URI位置的文件。
  (6)OPTIONS：查询相应URI支持的HTTP方法。

  (7)TRACE 追踪路径，TRACE 方法是让 Web 服务器端将之前的请求通信环回给客户端的方法

### 2.2请求头

* 请求头：客户端浏览器告诉服务器一些信息

* 请求头名称：请求头值

* 常见的请求头：

  1. User-Agent：浏览器告诉服务器，我访问你使用的浏览器版本信息

     * 可以在服务器端获取该头的信息，解决浏览器的兼容性问题

  2. Referer ： http：//localhost/login.html

     * 告诉服务器，当前请求从哪里来

       作用：1. 防盗链    2. 统计工作

### 2.3请求空行

空行，就是用来分割POST请求的请求头和请求体

### 2.4请求体（正文）

（如果请求方法是GET则没有请求体 如果是POST则有）

* 封装POST请求消息的请求参数

### 2.5请求特征

1. 支持客户-服务器模式

2. 简单快速：客户向服务器请求服务时，只需传送请求方法和路径

3. 灵活：HTTP 允许传输任意类型的数据对象

4. 无连接：限制每次连接只处理一个请求

   （服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间）                                        

5. 无状态：协议对于事务处理没有记忆能力

## 三、Request请求对象

### 3.1底层执行流程（了解）

服务器创建Servlet对象后、创建request请求和response响应对象；
request对象用于封装HTTP在当次请求中的数据；
response对象用于封装响应给客户端浏览器的数据；
服务器会调用Servlet对象的service()方法。将request对象和response对象作为参数传递给service()方法；
我们再使用请求和响应对象对数据进行操作；
服务器在进行响应之前会将response对象中的数据编译成HTTP响应的格式，响应给浏览器。

### 3.2常用方法

* 获取路径

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201106200938487.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80OTk5MjM5MA==,size_16,color_FFFFFF,t_70#pic_center)

URI:统一资源标识符，能唯一地标记互联网上资源

URL:统一资源定位符，也就是网址，是 URI 的一个子集

* 获取请求头

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201106201457901.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80OTk5MjM5MA==,size_16,color_FFFFFF,t_70#pic_center)

* 获取请求参数信息

  ![](C:\Users\86184\Desktop\大一上资料\工作室学习资料文件\笔记\watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80OTk5MjM5MA==,size_16,color_FFFFFF,t_70#pic_center)

* 流对象获取请求信息

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109110735980.png#pic_center)

### 3.3请求转发

* **请求转发：** 客户端的一次请求到达后，发现需要借助其他Servlet来实现功能；整个操作都在一次请求内

* **特点：**

  1. 浏览器地址栏不变
  2. 由于是在一次请求内，所以域对象中的数据不会丢失
  3. 负责转发的Servlet转发前后的**响应正文**会丢失
  4. 由转发的目的地来响应客户端

* **方法**

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109171919190.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80OTk5MjM5MA==,size_16,color_FFFFFF,t_70#pic_center)

### 3.4请求包含

* **请求包含：** 可以合并其他Servlet中的功能一起响应给客户端

* **特点：**

  1. 浏览器地址栏不变
  2. 域对象中的数据不丢失
  3. 被包含的Servlet**响应头**会丢失

* **方法：**（和请求转发用法一样）

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109192908869.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80OTk5MjM5MA==,size_16,color_FFFFFF,t_70#pic_center)

## 四、响应信息

响应消息：服务器端发送给客户端的数据

* 数据格式：响应行、响应头、响应空行、响应体
* <img src="C:\Users\86184\AppData\Roaming\Typora\typora-user-images\image-20220320192922377.png" alt="image-20220320192922377" style="zoom:50%;" />

### 4.1响应行

* HTTP协议版本号 状态码 状态消息 

### 4.2响应头

* 消息报头，用来说明客户端要使用的一些附加信息

### 4.3响应空行

* 空行，消息报头后面的空行是必须的

### 4.4响应体

* 响应正文，服务器返回给客户端的文本信息
  空行后面的html部分为响应正文

## 五、Response响应对象

### 5.1常见的状态码

* **1xx**:信息，服务器收到请求，需要请求者继续执行操作

***

* **2xx**:成功，操作被成功接收并处理

**200：请求被正常处理**
204：请求被受理但没有资源可以返回
206：客户端只是请求资源的一部分，服务器只对请求的部分资源执行GET方法，相应报文中通过Content-Range指定范围的资源

***

* **3xx**：重定向，需要进一步的操作以完成请求

**301：永久性重定向**
**302：临时重定向**
303：与302状态码有相似功能，只是它希望客户端在请求一个URI的时候，能通过GET方法重定向到另一个URI上
304：发送附带条件的请求时，条件不满足时返回，与重定向无关
307：临时重定向，与302类似，只是强制要求使用POST方法

***

* **4xx**：客户端错误，请求包含语法错误或无法完成请求

**400：请求报文语法有误，服务器无法识别**
**401：请求需要认证**
**403：请求的对应资源禁止被访问**
**404：服务器无法找到对应资源**

***

* **5xx**：服务器错误，服务器在处理请求的过程中发生了错误

**500：服务器内部错误**
**503：服务器正忙**

### 5.2字节流响应消息

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109201627732.png#pic_center)

### 5.3字符流响应消息

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109201658257.png#pic_center)

### 5.4设置缓存

* **缓存：** 对于不经常变化的数据，我们可以设置合理缓存时间，以避免浏览器频紧请求服务器

* **方法：**

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109201926548.png#pic_center)

### 5.5定时刷新（重点）

* **定时刷新：** 过了指定时间后，页面自动进行跳转

* **方法：**

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109202042106.png#pic_center)

### 5.6请求重定向（重点）

* **重定向：**我们可以选择让别人来为我们处理响应，把请求重定向到一个完全不同的URL，或者可以把请求分派给Web应用的另一个组件（通常是一个JSP）
* **实现重定向的方式：**
   1. 标准方式：（设置请求头和状态码）
  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109202553563.png#pic_center)
   2. 简写形式：
  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201109202626872.png#pic_center)
  ![在这里插入图片描述](https://img-blog.csdnimg.cn/2020110920272362.png#pic_center)

### 5.7转发和重定向的区别

|                         | 转发                                          | 重定向                                                       |
| ----------------------- | --------------------------------------------- | ------------------------------------------------------------ |
| **地址栏变化**          | 不改变地址栏中的URL                           | 改变地址栏                                                   |
| **跳转范围**            | 只能访问到当前web应用中的内容                 | 则可以访问到任意web应用中的内容                              |
| **request对象作用范围** | 在转发后的页面中仍然可以使用原来的request对象 | 原来的request对象则失去作用；所以，如果想要在多个页面使用相同的request对象，那么只能使用**转发**，而不能使用重定向 |

【注意】：

​		重定向其实是发生了两次请求，而request的请求域作用范围是一次请求内，所以不能实现数据共享。
  要想实现数据共享，要么提升作用域，要么只能在当前作用域范围能实现对应的操作

## 六、其他内容

### 6.1HTTP请求报文与响应报文格式

* 请求报文包含三部分：
  a、请求行：包含请求方法、URI、HTTP版本信息
  b、请求首部字段
  c、请求内容实体

* 响应报文包含三部分：
  a、状态行：包含HTTP版本、状态码、状态码的原因短语
  b、响应首部字段
  c、响应内容实体

### 6.2HTTP的缺点与HTTPS

a、通信使用明文不加密，内容可能被窃听
b、不验证通信方身份，可能遭到伪装
c、无法验证报文完整性，可能被篡改

HTTPS就是HTTP加上加密处理（一般是SSL安全通信线路）+认证+完整性保护